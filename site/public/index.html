<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petit Café</title>
    <link rel="icon" href="./images/icon.png">
    <link rel="stylesheet" href="./style(p).css">
    <script src="./js/funcoes.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.11/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.11/dist/sweetalert2.min.css" rel="stylesheet">
</head>

<body>
    <div class="cabeçalho">
        <div class="navbar">
            <ul class="navlist">
                <aside id="menu_oculto" class="menu_oculto">
                    <a href="javascript:void(0)" class="botao_fechar" onclick="menu_fechar()">&times;</a>
                    <a href="javascript:void(0)" onclick="mostrar_popup_login()"><img
                            src="./images/questionarioIcon.png" alt=""> Questionário</a>
                    <a href="javascript:void(0) " onclick="mostrar_popup_login()"> <img src="./images/ranking.png"
                            alt=""> Dashboard</a>
                    <a href="javascript:void(0) " onclick="mostrar_popup_login()"> <img src="./images/receita.png"
                            alt=""> Receitas</a>
                </aside>
                <li>
                    <span class="botao_menu" id="botao_menu" onclick="abrir_menu()">&#9776;</span>
                </li>
                <li>
                    <a href="#sobre_mim">SOBRE</a>
                </li>
                <li>
                    <a href=""><img class="nav_logo" src="./images/Petit Café (5).png" alt=""></a>
                </li>
                <li>
                    <a href="javascript:void(0)" onclick="mostrar_popup_login()">LOGIN</a>
                </li>
                <li>
                    <a href="javascript:void(0)" onclick="mostrar_popup_cadastro()">CADASTRO</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="container">
        <div class="box">
            <h2>Valorize o café da manhã: um momento para saborear o presente.</h2>
            <div class="conteudo_inicio">
                A oportunidade única de conexão com a família, um momento para sentar juntos à mesa e conversar antes de
                começar a correria do dia. Não deixe de valorizar esse momento tão especial, pois ele pode influenciar
                positivamente o seu dia inteiro.

            </div>
        </div>
    </div>
    <div class="container-conteudo">
        <div class="container-left">
            <div class="div-titulo">
                <spam id="sobre_mim">Sobre mim</sapm>
            </div>
            <div class="div-txt">
                <spam>
                    Olá, sou José Ramon e criei este site com muito carinho para falar sobre algo que é muito importante
                    na minha vida: o café da manhã.<br> Desde pequeno, sempre tive um apreço especial por essa refeição
                    e tudo que ela representa.<br> Além de ser considerada a mais importante do dia, é também o momento
                    em
                    que consigo sentar à mesa com a minha família e conversar sobre tudo o que está acontecendo em
                    nossas vidas. decidi compartilhar minhas experiências e receitas neste site.<br> Aqui você
                    encontrará desde opções simples para o dia a dia até receitas mais elaboradas para ocasiões
                    especiais.
                </spam>
            </div>
        </div>
        <div class="container-right">
            <img src="./images/foto_eu.png" alt="">
        </div>
    </div>
    <div class="conteiner-linha">
        <div class="linha">
        </div>
    </div>

    <div class="container-valores-corpo">
        <div class="div-titulo">
            <spam>Valores</sapm>
        </div>
        <div class="containar-valores">
            <div class="valor">
                <img src="./images/Autonomia.png" alt="">
                <div class="titulo-img">
                    <span>AUTONOMIA</span>
                </div>
                <div class="texto-img">
                    <span>Ter autonomia no café da manhã é poder escolher o que é melhor para o seu corpo e
                        mente.</span>
                </div>
            </div>
            <div class="valor">
                <img src="./images/responsabilidade.png" alt="">
                <div class="titulo-img">
                    <span>RESPONSABILIDADE</span>
                </div>
                <div class="texto-img">
                    <span> Assumir a responsabilidade por nossas escolhas alimentares, cultivasse um hábito saudável que
                        reflete em todas as áreas de nossas vidas.</span>
                </div>
            </div>
            <div class="valor">
                <img src="./images/resiliencia.png" alt="">
                <div class="titulo-img">
                    <span>RESILIÊNCIA</span>
                </div>
                <div class="texto-img">
                    <span> Assim como um café da manhã nutritivofortalece para encarar o dia, a resiliência fortalece
                        para superar os desafios da vida.</span>
                </div>
            </div>
        </div>
    </div>
    <div class="conteiner-linha">
        <div class="linha">
        </div>
    </div>

    <div class="container-img">
        <div class="img-footer" id="div_exibir">
        </div>
        <span>&hearts;</span>
    </div>



    <div class="footer">
        <div class="footer-cafe">
            <img src="./images/icon_footer.png" alt="">
        </div>
        <div class="redes">
            <div class="github">
                <a href="https://github.com/JRamonPere">
                    <img src="./images/github.png" alt="">
                    <span>/JRamonPere</span>
                </a>
            </div>
            <div class="linkedin">
                <a href="https://www.linkedin.com/in/ramon-pereira-5293b5215/">
                    <img src="./images/linkedin.png" alt="">
                    <span>/Ramon Pereira</span>
                </a>
            </div>
        </div>
        <div class="footer-seta">
            <a href="#">
                <img src="./images/Seta-Cima-Png-removebg-preview.png" alt="" class="seta-icon">
            </a>
        </div>
    </div>


    <!-- Tela de login -->
    <div class="popup disable" id="popup_sim_login">
        <div class="conteudo-popup">
            <div class="fechar-popup"><a href="./index.html">&times;</a></div>
            <h1>LOGIN</h1>
            <form action="#">
                <input type="text" placeholder="Email" id="email_input">
                <input type="password" placeholder="Senha" id="senha_input">
            </form>
            <div class="lembrar-senha">
                <input type="checkbox" id="checkbox">
                <label for="checkbox">Lembrar senha</label>
            </div>
            <button onclick="entrar()">Entrar</button>
            <div class="cadastrar">
                Não possui conta? <a href="javascript:void(0)" onclick="mostrar_popup_cadastro()">Cadastre Aqui!</a>
            </div>
        </div>

        <!-- Tela de Cadastro -->
    </div>
    <div class="popup disable-cadastro" id="popup_sim_cadastro">
        <div class="conteudo-popup-cadastro">
            <div class="fechar-popup-cadastro"><a href="./index.html">&times;</a></div>
            <h1>CADASTRO</h1>
            <form>
                <input type="text" placeholder="Nome" id="nome">
                <input type="text" placeholder="Email" id="email">
                <input type="password" placeholder="Senha" id="senha">
                <input type="password" placeholder="Confirmar Senha" id="confirmarSenha">
            </form>
            <div class="lembrar-senha-cadastro">
                <input type="checkbox" id="checkbox">
                <label for="checkbox">Concordo com<a href="#" class="termos">Termos & Condiçoes</a></label>
            </div>
            <button onclick="cadastrar()">Cadastrar</button>
            <div class="logar">
                Já possui conta?<a href="javascript:void(0)" onclick="mostrar_popup_login()">Login</a>
            </div>
        </div>
    </div>
    <!-- Tela IMC -->

    <div class="popup disable" id="popup_sim_imc">
        <div class="conteudo-popup">
            <h1>Calcule seu IMC</h1><br>
            <form action="#">
                <input type="number" placeholder="Altura" id="altura_input">
                <input type="number" placeholder="Peso" id="peso_input">
            </form>
            <button onclick="calcular_imc()">Calcular</button>
        </div>
    </div>
    <link rel="stylesheet" href="./dashboard/dashboard.html">
</body>
<!-- Tela IMC -->

</html>
<script>


    function cadastrar() {
        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var nomeVar = nome.value;
        var emailVar = email.value;
        var senhaVar = senha.value;
        var confirmacaoSenhaVar = confirmarSenha.value;
        if (nomeVar == "" || emailVar == "" || senhaVar == "" || confirmacaoSenhaVar == "") {

            Swal.fire({
                icon: 'error',
                title: 'Cadastro não realizado',
                text: `Preencha todos os campos!`,
            })
            return false;
        }
        else {
            Swal.fire(
                'Cadastro realizado!'
            )
        }

        // Enviando o valor da nova input
        fetch("/usuarios/cadastrar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                nomeServer: nomeVar,
                emailServer: emailVar,
                senhaServer: senhaVar
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {

                setTimeout(mostrar_popup_login(), 2500)


            } else {
                throw ("Houve um erro ao tentar realizar o cadastro!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
    }


    function entrar() {
        var emailVar = email_input.value;
        var senhaVar = senha_input.value;

        if (emailVar == "" || senhaVar == "") {
            Swal.fire({
                icon: 'error',
                title: 'Login não realizado',
                text: `Preencha todos os campos!`,
            })
            return false;
        }
        else {

            //setInterval(sumirMensagem, 5000)
        }

        console.log("FORM LOGIN: ", emailVar);
        console.log("FORM SENHA: ", senhaVar);

        fetch("/usuarios/autenticar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                emailServer: emailVar,
                senhaServer: senhaVar
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));

                    sessionStorage.EMAIL_USUARIO = json.email;
                    sessionStorage.NOME_USUARIO = json.nome;
                    sessionStorage.ID_USUARIO = json.idUsuario;
                    sessionStorage.PESO_USUARIO = json.peso;
                    sessionStorage.ALTURA_USUARIO = json.altura;

                    console.log(json.id)
                    const Toast = Swal.mixin({
                        toast: true,
                        position: 'top-end',
                        showConfirmButton: false,
                        timer: 3000,
                        timerProgressBar: true,
                        didOpen: (toast) => {
                            toast.addEventListener('mouseenter', Swal.stopTimer)
                            toast.addEventListener('mouseleave', Swal.resumeTimer)
                        }
                    })

                    if (json.idImc == null) {
                        Toast.fire({
                            icon: 'success',
                            title: 'Signed in successfully'
                        })
                        setTimeout(mostrar_popup_imc(), 3000)
                    } else {
                        const Toast = Swal.mixin({
                            toast: true,
                            position: 'top-end',
                            showConfirmButton: false,
                            timer: 3000,
                            timerProgressBar: true,
                            didOpen: (toast) => {
                                toast.addEventListener('mouseenter', Swal.stopTimer)
                                toast.addEventListener('mouseleave', Swal.resumeTimer)
                            }
                        })

                        Toast.fire({
                            icon: 'success',
                            title: 'Signed in successfully'
                        })
                        setTimeout(function () {
                            window.location = "./questionario.html";
                        }, 3000);

                    }
                });

            } else {
                Swal.fire({
                    title: 'Opss..',
                    icon: 'warning',
                    html: '<b>Email ou senha invalido!<b>',
                })
                resposta.text().then(texto => {
                    console.error(texto);
                    finalizarAguardar(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }

    function calcular_imc() {
        //Recupere o valor da nova input pelo nome do id
        // Agora vá para o método fetch logo abaixo
        var idUsuario = sessionStorage.ID_USUARIO
        var alturaVar = Number(altura_input.value);
        var pesoVar = Number(peso_input.value);
        var valorImc = parseInt(Number(pesoVar / (alturaVar * alturaVar)))
        if (alturaVar == "" || pesoVar == "") {
            Swal.fire({
                icon: 'error',
                title: 'Cadastro não realizado',
                text: `Preencha todos os campos!`,
            })
            return false;
        }
        else {
            if (valorImc < 18) {
                Swal.fire({
                    title: `IMC: ${valorImc}!`,
                    html: '<b>Recomenda-se consumir entre 600-700 kcal no café da manhã para aumentar o peso.<b>',
                    imageUrl: 'https://media.tenor.com/yIyZlpkh1nQAAAAC/comilona-festin.gif',
                    imageWidth: 400,
                    imageHeight: 200,
                    imageAlt: 'Custom image',
                })
                setTimeout(mostrar_popup_login(), 3000);
            } else if (valorImc >= 18 && valorImc < 25) {
                Swal.fire({
                    title: `IMC: ${valorImc}!`,
                    html: '<b>Recomenda-se consumir entre 500-600 kcal no café da manhã para manter o peso saudável.<b>',
                    imageUrl: 'https://media.tenor.com/21p1AuG69agAAAAC/im-awake-exercise.gif',
                    imageWidth: 400,
                    imageHeight: 200,
                    imageAlt: 'Custom image',
                })
                setTimeout(mostrar_popup_login(), 3000);
            } else if (valorImc >= 25) {
                Swal.fire({
                    title: `IMC: ${valorImc}!`,
                    html: '<b>Recomenda-se consumir entre 300-400 kcal no café da manhã para reduzir o peso.<b>',
                    imageUrl: 'https://media.tenor.com/q_mK_y7FcHoAAAAd/michael-scott-office.gif',
                    imageWidth: 400,
                    imageHeight: 200,
                    imageAlt: 'Custom image',
                })
                setTimeout(mostrar_popup_login(), 3000);
            } 
        }

        // Enviando o valor da nova input
        fetch(`/usuarios/calcular_imc/${idUsuario}`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                alturaServer: alturaVar,
                pesoServer: pesoVar,
                idUsuario: idUsuario
            })
        }).then(function (resposta) {

            console.log("resposta: ", resposta);

            if (resposta.ok) {

                setTimeout(mostrar_popup_login(), 3000);

            } else {
                throw ("Houve um erro ao tentar realizar o calculo!");
            }
        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });

        return false;
    }
</script>